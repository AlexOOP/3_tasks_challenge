#!/bin/bash

#####################################################
#Depends on "expect"
# yum install -y expect
####################################################

USERNAME="ec2-user"
IP="$1"
PATHTODIR="${2:-'meta-data'}"


MaxThread=1
###################################################
ABSOLUTE_FILENAME=`readlink -e "$0"`
WORKDIR=`dirname "$ABSOLUTE_FILENAME"`
        if      [ ! -d $WORKDIR/log ];
        then    mkdir $WORKDIR/log
        fi
##################################################

ssh -oStrictHostKeyChecking=no ec2-user@$IP -p 22 "
echo -n ' '
curl http://169.254.169.254/latest/$PATHTODIR/ > test.txt
echo -e '\n'
echo --------------------------------------------------------------------------------
echo --------------------------------------------------------------------------------
echo --------------------------------------------------------------------------------
echo -n $PATHTODIR \:;echo -n ' ';cat test.txt;echo -e '\n'; echo -e '\n'
echo --------------------------------------------------------------------------------
echo --------------------------------------------------------------------------------
echo --------------------------------------------------------------------------------
exit
"
